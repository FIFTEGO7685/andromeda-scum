<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Вход / Регистрация — Andromeda Scum</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <div class="container">
    <h2>Регистрация</h2>
    <input type="text" id="regNick" placeholder="Ник" />
    <input type="email" id="regEmail" placeholder="Email" />
    <input type="password" id="regPass" placeholder="Пароль" />
    <button onclick="register()">Зарегистрироваться</button>

    <h2>Вход</h2>
    <input type="email" id="loginEmail" placeholder="Email" />
    <input type="password" id="loginPass" placeholder="Пароль" />
    <button onclick="login()">Войти</button>

    <div id="message"></div>
    <div id="userInfo" style="margin-top: 20px;"></div>
  </div>

  <script>
    // ВСТАВЬ СВОЙ КОНФИГ НИЖЕ
    const firebaseConfig = {
      apiKey: "AIzaSyAbj4KLyz0odB766u0RVW-gVEB-OskamQU",
      authDomain: "andromeda-scum.firebaseapp.com",
      projectId: "andromeda-scum",
      storageBucket: "andromeda-scum.firebasestorage.app",
      messagingSenderId: "641756358533",
      appId: "1:641756358533:web:05e4dd43414c6238c786ec",
      measurementId: "G-3CP2PRT3EY"
      authDomain: "ТВОЙ_ПРОЕКТ.firebaseapp.com",
      projectId: "ТВОЙ_ПРОЕКТ",
      storageBucket: "ТВОЙ_ПРОЕКТ.appspot.com",
      messagingSenderId: "ТВОЙ_ID",
      appId: "ТВОЙ_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const messageEl = document.getElementById('message');
    const userInfoEl = document.getElementById('userInfo');

    function register() {
      const nick = document.getElementById('regNick').value.trim();
      const email = document.getElementById('regEmail').value.trim();
      const password = document.getElementById('regPass').value;

      if (!nick || !email || !password) {
        messageEl.style.color = 'red';
        messageEl.textContent = 'Заполните все поля!';
        return;
      }

      messageEl.textContent = 'Регистрация...';
      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          const uid = userCredential.user.uid;
          return db.collection('users').doc(uid).set({ nick });
        })
        .then(() => {
          messageEl.style.color = 'lightgreen';
          messageEl.textContent = 'Регистрация успешна! Войдите.';
        })
        .catch(e => {
          messageEl.style.color = 'red';
          messageEl.textContent = 'Ошибка: ' + e.message;
        });
    }

    function login() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPass').value;

      messageEl.textContent = 'Вход...';
      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          const uid = userCredential.user.uid;
          return db.collection('users').doc(uid).get();
        })
        .then(doc => {
          if (doc.exists) {
            const nick = doc.data().nick;
            messageEl.style.color = 'lightgreen';
            messageEl.textContent = 'Вход успешен!';
            userInfoEl.innerHTML = `<p>Добро пожаловать, <strong>${nick}</strong>!</p>`;
          } else {
            messageEl.style.color = 'orange';
            messageEl.textContent = 'Вход успешен, но ник не найден.';
          }
        })
        .catch(e => {
          messageEl.style.color = 'red';
          messageEl.textContent = 'Ошибка: ' + e.message;
        });
    }
  </script>
</body>
</html>